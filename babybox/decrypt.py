from Crypto.Util.number import bytes_to_long, long_to_bytes
from Crypto import Random
import Crypto
import sys
import libnum

n1=131320987743362426332084589486950491265357269772799114975273891777955131035804953564304876395747390796423673567943706999221381421313481559780877980034059601116601966435857931638898346001757148106737776479496286854747047627401050036966209776864576988603985664506756469612078365341281922478809929335096821358329
n2=65095998613216804249196061516938712300227085527062102358993340662434567333586561217813391688177830548933906998849400013337053089362910100502893204248854024469810730454701254874414838436731955018243155771692582036491350625276596714770192202107855483551540628383138356667237253419322772987371060676372466386551
n3=87048474571241288811938645082531942938745030553073765014080822772553196994025422789301206427786229496888641356334456797202187945634583585784360809406190038268945526187449436969593428261964874122644944533579682923851963054400681777933543768910369060044158766038229771139676572545847854156209732346330901661291
c1=113712000597977824965691682776711405114837984563720370601871244778948862236822745701501363329258337050854622545786281477119496643747800040181167304171035406013047663511900291036521051197514035197524109317017696416920529145058437187328423221312188624229387013701089127177258343140430317543396246623912243648494
c2=46620520737556426747925375468170090473097830263034847904323251392150460562587689617032157263102428864696409583425027216532533435360850430505384792055511767965960640368357921312709063866300873412156312904267383967062765836437769484490736687413933273742194919063329264825288559129610843797876395913447474621861
c3=50780780560188468619342887945551672354406752563057720615497061585443693079673540805069247467211286120704533393462373399482884797760849192052595144392270311860525345726690000603958995333514042239136397734717458639193599449345270638266680341706317078195121785829892107275998575679344734259041207171298626481107

if (len(sys.argv)>1):
    c1=int(sys.argv[1])
if (len(sys.argv)>2):
    c2=int(sys.argv[2])
if (len(sys.argv)>3):
    c3=int(sys.argv[3])
if (len(sys.argv)>4):
    n1=int(sys.argv[4])
if (len(sys.argv)>5):
    n2=int(sys.argv[5])
if (len(sys.argv)>6):
    n3=int(sys.argv[6])                
e=3



mod=[n1,n2,n3]
rem=[c1,c2,c3]

res=libnum.solve_crt(rem,mod)

print("\n\nAnswer:")
print(f"\nCipher 1: {c1}, N1={n1}")
print(f"Cipher 2: {c2}, N2={n2}")
print(f"Cipher 3: {c3}, N3={n3}")


print(f"\nWe can solved M^e with CRT to get {res}")
val=libnum.nroot(res,3)
print(f"\nIf we assume e=3, we take the third root to get: {val}")
print("Next we convert this integer to bytes, and display as a string.")
print(f"\nDecipher: {long_to_bytes(val)}")